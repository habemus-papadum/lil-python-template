# Copier template configuration
_min_copier_version: "9.0.0"

# Jinja extensions for time/date support
_jinja_extensions:
  - jinja2_time.TimeExtension

# Template settings
_subdirectory: template

# Template suffixes - treat .ipynb files as Jinja templates
_templates_suffix: ".jinja"

# Tasks to run after generation
_tasks:
  - command: "uv sync"
  - command: "chmod +x scripts/*.sh"
  - command: "cd docs && ln -sf ../README.md index.md"
  - command: "git init"
    when: "{{ init_git_and_github }}"
  - command: "git add ."
    when: "{{ init_git_and_github }}"
  - command: "git commit -m 'Initial commit from lil-python-template'"
    when: "{{ init_git_and_github }}"
  - command: "gh repo create {{ github_username }}/{{ github_repo_name }} --public --source=. --remote=origin --push"
    when: "{{ init_git_and_github }}"
  # - command: "gh api method POST -H 'Accept: application/vnd.github+json'  repos/{{ github_username }}/{{ github_repo_name }}/pages  -f build_type='workflow'"
  #   when: "{{ init_git_and_github }}"
  # - command: "gh api --method POST -H 'Accept: application/vnd.github+json' /repos/{{ github_username }}/{{ github_repo_name }}/environments/github-pages/deployment-branch-policies -f name='v*' -f type='tag'"
  #   when: "{{ init_git_and_github }}"

# Questions for the user
package_name:
  type: str
  help: What is the package name? (e.g., my-awesome-package)
  default: "{{ (_copier_conf.dst_path | basename)[5:] if (_copier_conf.dst_path | basename).startswith('pdum_') else (_copier_conf.dst_path | basename) }}"
  validator: "{% if not (_copier_conf.dst_path | basename).startswith('pdum_') %}Destination directory must be prefixed with 'pdum_'{% endif %}"

github_repo_name:
  type: str
  help: GitHub repository name (keeps pdum_ prefix from destination directory)
  default: "{{ _copier_conf.dst_path | basename }}"

package_slug:
  type: str
  help: Python module name (derived from package_name)
  default: "{{ package_name | replace('-', '_') | replace(' ', '_') | lower }}"

package_description:
  type: str
  help: Brief description of the package
  default: "A Python package"

python_version:
  type: str
  help: Python version to use
  default: "3.12"

author_name:
  type: str
  help: Author name
  default: "Nehal Patel"

author_email:
  type: str
  help: Author email
  default: "nehal@alum.mit.edu"

github_username:
  type: str
  help: GitHub username
  default: "habemus-papadum"


init_git_and_github:
  type: bool
  help: Initialize git repository and create GitHub repo?
  default: true
