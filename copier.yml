# Copier template configuration
_min_copier_version: "9.0.0"

# Jinja extensions for time/date support
_jinja_extensions:
  - jinja2_time.TimeExtension

# Template settings
_subdirectory: template

# Template suffixes - treat .ipynb files as Jinja templates
_templates_suffix: ".jinja"

# Tasks to run after generation
_tasks:
  - command: "uv sync"
  - command: "chmod +x scripts/*.sh"
  - command: "cd docs && ln -sf ../README.md index.md"
  - command: "rm -rf widgets src/{{ package_slug }}/widgets package.json pnpm-workspace.yaml .npmrc .pnpm-approvals.yaml"
    when: "{{ not include_ts_widgets }}"
  - command: "git init"
    when: "{{ init_git_and_github }}"
  - command: "git add ."
    when: "{{ init_git_and_github }}"
  - command: "git commit -m 'Initial commit from lil-python-template'"
    when: "{{ init_git_and_github }}"
  - command: "gh repo create {{ github_username }}/{{ package_name }} --public --source=. --remote=origin --push"
    when: "{{ init_git_and_github }}"
  - command: "./scripts/publish.sh"
    when: "{{ init_git_and_github and publish_to_pypi }}"

# Questions for the user
package_name:
  type: str
  help: What is the package name? (e.g., my-awesome-package)
  default: "{{ _copier_conf.dst_path | basename }}"
  validator: "{% if not package_name %}Package name is required{% endif %}"

package_slug:
  type: str
  help: Python module name (derived from package_name)
  default: "{{ package_name | replace('-', '_') | replace(' ', '_') | lower }}"

package_description:
  type: str
  help: Brief description of the package
  default: "A Python package"

python_version:
  type: str
  help: Python version to use
  default: "3.12"

author_name:
  type: str
  help: Author name
  default: "Nehal Patel"

author_email:
  type: str
  help: Author email
  default: "nehal@alum.mit.edu"

github_username:
  type: str
  help: GitHub username
  default: "habemus-papadum"

include_ts_widgets:
  type: bool
  help: Include the TypeScript widget workspace (pnpm, widgets submodule, CI integration)?
  default: true

widget_package_name:
  type: str
  help: npm package name (optionally scoped) for the widgets workspace
  default: "@{{ github_username | replace('_', '-') | replace(' ', '-') | lower }}/{{ package_slug | replace('_', '-') }}-widgets"
  when: "{{ include_ts_widgets }}"

widget_global_name:
  type: str
  help: Global variable exposed by the widgets IIFE bundle
  default: "{{ package_slug | replace('_', ' ') | title | replace(' ', '') }}Widgets"
  when: "{{ include_ts_widgets }}"

init_git_and_github:
  type: bool
  help: Initialize git repository and create GitHub repo?
  default: true

publish_to_pypi:
  type: bool
  help: Publish package to PyPI to reserve the name?
  default: true
  when: "{{ init_git_and_github }}"
